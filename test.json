{
  "variables": {
    "aws_access_key": "",
    "aws_secret_key": "",
	"build_number": "",
	"INSTANCE_USER": "admin",
	"NVM_VERSION": "v0.25.4",
	"NODE_VERSION": "0.12"
  },
  "builders": [{
    "type": "amazon-ebs",
    "access_key": "{{user `aws_access_key`}}",
    "secret_key": "{{user `aws_secret_key`}}",
    "region": "eu-west-1",
    "source_ami": "ami-a10897d6",
    "instance_type": "t2.micro",
    "ssh_username": "ec2-user",
    "ami_name": "{{user `build_number`}}"
  }],
  "provisioners": [
  {
  "type": "file",
  "source": "nginx/walkdesigner-prod/nginx.conf",
  "destination": "/tmp/nginx.conf"
},
{
  "type": "file",
  "source": "nginx/walkdesigner-prod/sites-available/walkdesigner.com",
  "destination": "/tmp/walkdesigner.com"
},
{
  "type": "shell",
  "environment_vars": [
    "INSTANCE_USER={{user `INSTANCE_USER`}}",
    "NVM_VERSION={{user `NVM_VERSION`}}",
    "NODE_VERSION={{user `NODE_VERSION`}}"
  ],
  "script": "./packer-nginx.sh"
}]
}
